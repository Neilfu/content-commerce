# Strapi æƒé™é…ç½® - å¿«é€Ÿå‚è€ƒ

## ğŸ¯ ç›®æ ‡

é…ç½® Strapi æƒé™ä»¥æ”¯æŒï¼š
1. ç”¨æˆ·æ³¨å†Œæ—¶åˆ›å»º Verification Token
2. ç”¨æˆ·æ³¨å†Œæ—¶åˆ›å»º User Profile
3. é‚®ç®±éªŒè¯æ—¶æŸ¥è¯¢å’Œæ›´æ–° Token

---

## ğŸ“‹ é…ç½®æ¸…å•

### Public Role (æœªç™»å½•ç”¨æˆ·)

è®¿é—®: http://localhost:1337/admin/settings/users-permissions/roles

#### Verification-token
- [x] create - å…è®¸åˆ›å»ºéªŒè¯ä»¤ç‰Œ
- [x] findOne - å…è®¸æŸ¥è¯¢å•ä¸ªä»¤ç‰Œ

#### User-profile
- [x] findOne - å…è®¸æŸ¥è¯¢ç”¨æˆ·èµ„æ–™

### Authenticated Role (å·²ç™»å½•ç”¨æˆ·)

#### Verification-token
- [x] find - å…è®¸æŸ¥è¯¢ä»¤ç‰Œåˆ—è¡¨
- [x] findOne - å…è®¸æŸ¥è¯¢å•ä¸ªä»¤ç‰Œ

#### User-profile
- [x] find - å…è®¸æŸ¥è¯¢èµ„æ–™åˆ—è¡¨
- [x] findOne - å…è®¸æŸ¥è¯¢å•ä¸ªèµ„æ–™
- [x] update - å…è®¸æ›´æ–°èµ„æ–™

---

## ğŸ–¼ï¸ é…ç½®æˆªå›¾å‚è€ƒ

### Public Role é…ç½®

```
Settings > Users & Permissions > Roles > Public

â”Œâ”€ Verification-token â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¡ count                          â”‚
â”‚ â˜‘ create         â† å‹¾é€‰è¿™ä¸ª      â”‚
â”‚ â–¡ delete                         â”‚
â”‚ â–¡ find                           â”‚
â”‚ â˜‘ findOne        â† å‹¾é€‰è¿™ä¸ª      â”‚
â”‚ â–¡ update                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ User-profile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¡ count                          â”‚
â”‚ â–¡ create                         â”‚
â”‚ â–¡ delete                         â”‚
â”‚ â–¡ find                           â”‚
â”‚ â˜‘ findOne        â† å‹¾é€‰è¿™ä¸ª      â”‚
â”‚ â–¡ update                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Save] â† ç‚¹å‡»ä¿å­˜
```

### Authenticated Role é…ç½®

```
Settings > Users & Permissions > Roles > Authenticated

â”Œâ”€ Verification-token â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¡ count                          â”‚
â”‚ â–¡ create                         â”‚
â”‚ â–¡ delete                         â”‚
â”‚ â˜‘ find           â† å‹¾é€‰è¿™ä¸ª      â”‚
â”‚ â˜‘ findOne        â† å‹¾é€‰è¿™ä¸ª      â”‚
â”‚ â–¡ update                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ User-profile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¡ count                          â”‚
â”‚ â–¡ create                         â”‚
â”‚ â–¡ delete                         â”‚
â”‚ â˜‘ find           â† å‹¾é€‰è¿™ä¸ª      â”‚
â”‚ â˜‘ findOne        â† å‹¾é€‰è¿™ä¸ª      â”‚
â”‚ â˜‘ update         â† å‹¾é€‰è¿™ä¸ª      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Save] â† ç‚¹å‡»ä¿å­˜
```

---

## âœ… éªŒè¯é…ç½®

é…ç½®å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š

### æ–¹æ³• 1: é€šè¿‡ Strapi ç•Œé¢

1. è¿›å…¥ Settings > Users & Permissions > Roles
2. ç‚¹å‡» Publicï¼ŒæŸ¥çœ‹é…ç½®æ˜¯å¦ä¿å­˜
3. ç‚¹å‡» Authenticatedï¼ŒæŸ¥çœ‹é…ç½®æ˜¯å¦ä¿å­˜

### æ–¹æ³• 2: é€šè¿‡ API æµ‹è¯•

```bash
# æµ‹è¯• Public æƒé™ - åˆ›å»º Verification Token
curl -X POST http://localhost:1337/api/verification-tokens \
  -H "Content-Type: application/json" \
  -d '{
    "data": {
      "token": "test-token",
      "email": "test@example.com",
      "userId": 1,
      "expiresAt": "2025-12-13T00:00:00.000Z",
      "used": false
    }
  }'

# åº”è¯¥è¿”å› 200 æˆ– 201ï¼Œè€Œä¸æ˜¯ 403
```

---

## ğŸš¨ å¸¸è§é—®é¢˜

### Q: æ‰¾ä¸åˆ° Verification-token æˆ– User-profile

**A**: Strapi å¯èƒ½è¿˜æ²¡æœ‰è¯†åˆ«æ–°çš„ Content Types

è§£å†³æ–¹æ¡ˆ:
1. ç¡®è®¤ schema.json æ–‡ä»¶åœ¨æ­£ç¡®ä½ç½®
2. é‡å¯ Strapi æœåŠ¡å™¨
3. æ£€æŸ¥ Strapi å¯åŠ¨æ—¥å¿—
4. åˆ é™¤ `.cache` æ–‡ä»¶å¤¹å¹¶é‡å¯

### Q: é…ç½®åä»ç„¶è¿”å› 403

**A**: æƒé™å¯èƒ½æ²¡æœ‰æ­£ç¡®ä¿å­˜

è§£å†³æ–¹æ¡ˆ:
1. åˆ·æ–°æµè§ˆå™¨
2. é‡æ–°é…ç½®å¹¶ç¡®ä¿ç‚¹å‡» Save
3. é‡å¯ Strapi
4. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

### Q: ä¸ç¡®å®šæ˜¯å¦é…ç½®æˆåŠŸ

**A**: ä½¿ç”¨ curl å‘½ä»¤æµ‹è¯• API

è§£å†³æ–¹æ¡ˆ:
```bash
# æµ‹è¯• create æƒé™
curl -X POST http://localhost:1337/api/verification-tokens \
  -H "Content-Type: application/json" \
  -d '{"data":{"token":"test","email":"test@test.com","userId":1,"expiresAt":"2025-12-13T00:00:00.000Z","used":false}}'

# å¦‚æœè¿”å› 403ï¼Œè¯´æ˜æƒé™æœªé…ç½®
# å¦‚æœè¿”å› 200/201ï¼Œè¯´æ˜æƒé™é…ç½®æˆåŠŸ
```

---

## ğŸ“ é…ç½®å®Œæˆå

å®Œæˆæƒé™é…ç½®åï¼Œè¿›è¡Œä»¥ä¸‹æµ‹è¯•ï¼š

1. âœ… æµ‹è¯•ç”¨æˆ·æ³¨å†Œ
2. âœ… æ£€æŸ¥ User Profile æ˜¯å¦åˆ›å»º
3. âœ… æ£€æŸ¥ Verification Token æ˜¯å¦ä¿å­˜
4. âœ… æµ‹è¯•é‚®ç®±éªŒè¯
5. âœ… æ£€æŸ¥ç”¨æˆ·çŠ¶æ€æ˜¯å¦æ›´æ–°

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿå¼€å§‹é…ç½®å§ï¼**

1. è®¿é—® http://localhost:1337/admin
2. æŒ‰ç…§ä¸Šé¢çš„æ¸…å•é…ç½®æƒé™
3. ä¿å­˜é…ç½®
4. è¿›è¡Œæµ‹è¯•
